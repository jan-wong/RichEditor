{"version":3,"sources":["webpack://RichEditor/webpack/universalModuleDefinition","webpack://RichEditor/webpack/bootstrap","webpack://RichEditor/./src/core/emitter.ts","webpack://RichEditor/./src/core/baseToolbar.ts","webpack://RichEditor/./src/toolbar/bold.ts","webpack://RichEditor/./src/core/RichEditor.ts"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","this","events","type","fn","push","onceFn","args","off","forEach","item","index","indexOf","splice","selected","el","createToolbarElement","handleClick","on","currentRange","startContainer","parentNode","tagName","getTagName","setActive","resetActive","addEventListener","changeActive","fire","execCommand","classList","add","remove","toolbar","document","createElement","innerHTML","currentSelection","querySelector","initEditor","initToolbar","appendP","handleLine","handleMouseDown","handleMouseLeave","handleMouseup","restoreRange","resetRange","br","appendChild","e","setTimeout","keyCode","querySelectorAll","length","getSelection","getRangeAt","removeAllRanges","addRange"],"mappings":"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","file":"RichEditor.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"RichEditor\"] = factory();\n\telse\n\t\troot[\"RichEditor\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","/**\n * 事件系统：管理事件的触发和监听\n */\nclass Emitter {\n    constructor() {\n        this.events = {};\n    }\n    on(type, fn) {\n        this.events[type] ? this.events[type].push(fn) : this.events[type] = [fn];\n    }\n    once(type, fn) {\n        const onceFn = (...args) => {\n            fn(...args);\n            this.off(type, fn);\n        };\n        this.events[type] ? this.events[type].push(onceFn) : this.events[type] = [onceFn];\n    }\n    off(type, fn) {\n        this.events[type] && this.events[type].forEach(item => {\n            if (item === fn) {\n                const index = this.events[type].indexOf(fn);\n                if (index > -1)\n                    this.events[type].splice(index, 1);\n            }\n        });\n    }\n    fire(type, ...args) {\n        this.events[type] && this.events[type].forEach(fn => {\n            fn(...args);\n        });\n    }\n}\nconst event = new Emitter();\nexport default event;\n","import event from './emitter';\nclass BaseToolbar {\n    constructor() {\n        this.selected = false;\n        this.el = this.createToolbarElement();\n        this.handleClick();\n        event.on('rangechange', currentRange => {\n            const startContainer = currentRange.startContainer;\n            const parent = startContainer.parentNode;\n            const tagName = parent.tagName;\n            tagName === this.getTagName() ? this.setActive() : this.resetActive();\n        });\n    }\n    handleClick() {\n        this.el.addEventListener('click', () => {\n            this.changeActive();\n            event.fire('restorerange');\n            this.execCommand();\n            event.fire('resetrange');\n        });\n    }\n    setActive() {\n        this.el.classList.add('active');\n        this.selected = true;\n    }\n    resetActive() {\n        this.el.classList.remove('active');\n        this.selected = false;\n    }\n    changeActive() {\n        this.selected ? this.resetActive() : this.setActive();\n    }\n}\nexport default BaseToolbar;\n","import BaseToolbar from \"../core/baseToolbar\";\nclass Bold extends BaseToolbar {\n    createToolbarElement() {\n        const toolbar = document.createElement('span');\n        toolbar.innerHTML = 'B';\n        return toolbar;\n    }\n    getTagName() {\n        return 'B';\n    }\n    execCommand() {\n        document.execCommand('bold');\n    }\n}\nexport default Bold;\n","import event from \"./emitter\";\nimport Bold from '../toolbar/bold';\nclass RichEditor {\n    constructor() {\n        this.currentSelection = null;\n        this.currentRange = null;\n        this.el = document.querySelector('.rich-editor_container');\n        this.initEditor();\n        this.initToolbar();\n    }\n    initEditor() {\n        this.appendP();\n        this.handleLine();\n        this.handleMouseDown();\n        this.handleMouseLeave();\n        this.handleMouseup();\n        event.on('restorerange', this.restoreRange.bind(this));\n        event.on('resetrange', this.resetRange.bind(this));\n    }\n    initToolbar() {\n        new Bold();\n    }\n    appendP() {\n        const p = document.createElement('p');\n        const br = document.createElement('br');\n        p.appendChild(br);\n        this.el.appendChild(p);\n    }\n    handleLine() {\n        this.el.addEventListener('keydown', (e) => {\n            setTimeout(() => {\n                if (e.keyCode === 8 && this.el.querySelectorAll('p').length === 0) {\n                    this.appendP();\n                }\n            }, 100);\n        });\n    }\n    handleMouseDown() {\n        this.el.addEventListener('mousedown', () => {\n            this.currentSelection = this.currentSelection || window.getSelection();\n        });\n    }\n    handleMouseup() {\n        this.el.addEventListener('mouseup', () => {\n            this.currentRange = this.currentSelection.getRangeAt(0);\n            event.fire('rangechange', this.currentRange);\n        });\n    }\n    handleMouseLeave() {\n        this.el.addEventListener('mouseleave', () => {\n            if (this.currentSelection) {\n                this.currentRange = this.currentSelection.getRangeAt(0);\n                event.fire('rangechange', this.currentRange);\n            }\n        });\n    }\n    restoreRange() {\n        this.currentSelection.removeAllRanges();\n        this.currentSelection.addRange(this.currentRange);\n    }\n    resetRange() {\n        this.currentRange = this.currentSelection.getRangeAt(0);\n    }\n}\nexport default RichEditor;\n"],"sourceRoot":""}